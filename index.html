<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5.0,user-scalable=yes" />
<title>ç²—å¤§ã”ã¿å¯¸æ³•åˆ¤å®šï¼ˆé›»è©±ç”³è¾¼ã‚µãƒãƒ¼ãƒˆç‰ˆï¼‰</title>
<style>
  body{
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ ProN", "Noto Sans JP", sans-serif;
    line-height: 1.6; margin: 0; background-color: #f4f4f9;
    -webkit-user-select: none; user-select: none;
  }
  #mainWrapper { padding: 16px; padding-bottom: 80px; max-width: 600px; margin: 0 auto; }
  h1{ font-size:1.2rem; margin:0 0 12px; color:#333; text-align:center; }
  
  .panel{ 
    border:1px solid #ddd; border-radius:12px; padding:16px; margin-bottom:20px; 
    background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  }
  h2 { font-size: 1rem; margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 8px; margin-bottom: 12px; }
  .row{ display:flex; flex-direction: column; gap:12px; }
  .col{ flex:1 1 100%; }
  
  canvas{
    width:100%; height:auto; display:block;
    border:2px dashed #ccc; border-radius:8px; background:#f0f0f0;
    touch-action:none; 
  }
  
  button, input[type="file"]::file-selector-button {
    background-color: #fff; border: 1px solid #ccc; border-radius: 6px;
    padding: 8px 12px; font-size: 14px; color: #333; cursor: pointer;
    touch-action: manipulation; transition: all 0.2s;
  }
  button:active { background-color: #eef; transform: translateY(1px); }
  button#topScale, button#sideScale { border-color: #2b74ff; color: #2b74ff; font-weight: bold; }
  
  .btn-row{ margin:8px 0; display:flex; flex-wrap:wrap; gap:8px; justify-content: center; }
  .muted{ color:#666; font-size:0.85em; }
  .pill{ display:inline-block; padding:2px 8px; border-radius:999px; background:#eee; margin-left:6px; font-size:0.8em; color:#555; }
  .result-text{ font-size:1.1rem; padding:4px 0; font-weight:bold; color:#0056b3; text-align: right; }
  .small{ font-size:0.85em; color:#666; margin-top:4px; }
  
  /* --- é›»è©±ç”¨ã‚«ãƒ³ãƒšã‚¨ãƒªã‚¢ --- */
  #phoneSupportPanel {
    border: 3px solid #ff9800; background-color: #fff8e1; 
    text-align: center; position: relative;
  }
  .memo-title {
    background: #ff9800; color: white; display: inline-block;
    padding: 4px 16px; border-radius: 99px; font-weight: bold; font-size: 0.9rem;
    margin-bottom: 12px;
  }
  .script-box {
    text-align: left; background: white; padding: 12px; border-radius: 8px;
    border: 1px solid #ffcc80; margin-bottom: 12px;
  }
  .script-line { font-size: 1.1rem; border-bottom: 1px dashed #eee; padding: 4px 0; }
  .script-label { color: #666; font-size: 0.8em; display: inline-block; width: 60px; }
  .script-val { font-weight: bold; font-size: 1.3em; color: #333; }
  
  .total-highlight { background-color: #e3f2fd; padding: 8px; border-radius: 4px; margin-top: 8px; text-align: center; }
  .total-label { color: #0d47a1; font-weight: bold; font-size: 0.9em; }
  .total-val { color: #0d47a1; font-weight: 900; font-size: 1.6em; }
  
  /* é›»è©±ç™ºä¿¡ãƒœã‚¿ãƒ³ */
  .call-btn {
    display: flex; align-items: center; justify-content: center; flex-direction: column;
    width: 100%; padding: 12px 0; margin-top: 10px;
    background-color: #00c853; color: white; font-weight: bold; font-size: 1.2rem;
    text-align: center; text-decoration: none; border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.15); border: none;
  }
  .call-btn:active { background-color: #009624; transform: translateY(2px); box-shadow: none; }
  .call-sub { font-size: 0.75rem; font-weight: normal; margin-top: 2px; }

  .grid{ display:grid; grid-template-columns:1fr; gap:16px; }
  @media (min-width:768px){ .grid{ grid-template-columns:1fr 1fr; } }
</style>
</head>
<body>

<div id="mainWrapper">
  <h1>ç²—å¤§ã”ã¿å¯¸æ³•åˆ¤å®š<br><span style="font-size:0.8em;color:#666">ï¼ˆé›»è©±ç”³è¾¼ã‚µãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ‰ï¼‰</span></h1>
  
  <p class="muted" style="text-align:center;">
    å†™çœŸã§å¯¸æ³•ã‚’æ¸¬ã‚‹ã¨ã€<b>é›»è©±ã§ä¼ãˆã‚‹ãŸã‚ã®ãƒ¡ãƒ¢</b>ãŒè‡ªå‹•ä½œæˆã•ã‚Œã¾ã™ã€‚<br>
    ãã®ã¾ã¾ã‚»ãƒ³ã‚¿ãƒ¼ã¸ç™ºä¿¡ã§ãã¾ã™ã€‚
  </p>

  <div class="grid">
    <div class="panel">
      <h2>â‘  ä¸Šã‹ã‚‰ã®å†™çœŸ (W / D)<span class="pill">TOP</span></h2>
      <input type="file" id="topFile" accept="image/*" style="width:100%"/>
      <div class="btn-row">
        <button id="topScale">ğŸ“ ã‚¹ã‚±ãƒ¼ãƒ«(æŒ‡ã‚ªãƒ•ã‚»ãƒƒãƒˆ)</button>
        <button id="topAuto">ğŸ¤– è‡ªå‹•æŠ½å‡º</button>
        <button id="topManual">ğŸ‘† æ‰‹å‹•çŸ©å½¢(æŒ‡ã‚ªãƒ•ã‚»ãƒƒãƒˆ)</button>
      </div>
      <div class="col">
        <canvas id="topCanvas" width="640" height="480"></canvas>
        <div class="small" id="topMsg">å†™çœŸã‚’é¸æŠã—ã¦ãã ã•ã„</div>
        <div class="result-text" id="topInfo">W: - / D: -</div>
      </div>
    </div>

    <div class="panel">
      <h2>â‘¡ æ¨ªã‹ã‚‰ã®å†™çœŸ (H)<span class="pill">SIDE</span></h2>
      <input type="file" id="sideFile" accept="image/*" style="width:100%"/>
      <div class="btn-row">
        <button id="sideScale">ğŸ“ ã‚¹ã‚±ãƒ¼ãƒ«(æŒ‡ã‚ªãƒ•ã‚»ãƒƒãƒˆ)</button>
        <button id="sideAuto">ğŸ¤– è‡ªå‹•æŠ½å‡º</button>
        <button id="sideManual">ğŸ‘† æ‰‹å‹•çŸ©å½¢(æŒ‡ã‚ªãƒ•ã‚»ãƒƒãƒˆ)</button>
      </div>
      <div class="col">
        <canvas id="sideCanvas" width="640" height="480"></canvas>
        <div class="small" id="sideMsg">å†™çœŸã‚’é¸æŠã—ã¦ãã ã•ã„</div>
        <div class="result-text" id="sideInfo">H: -</div>
      </div>
    </div>
  </div>

  <div class="panel" id="phoneSupportPanel">
    <div class="memo-title">ğŸ“ é›»è©±ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã¸ã®å›ç­”ãƒ¡ãƒ¢</div>
    
    <div id="scriptArea" style="display:none;">
      <div class="script-box">
        <div class="script-line">
          <span class="script-label">å¹…(W)</span>
          <span class="script-val" id="valW">---</span> cm
        </div>
        <div class="script-line">
          <span class="script-label">å¥¥è¡Œ(D)</span>
          <span class="script-val" id="valD">---</span> cm
        </div>
        <div class="script-line">
          <span class="script-label">é«˜ã•(H)</span>
          <span class="script-val" id="valH">---</span> cm
        </div>
        <div class="total-highlight">
          <div class="total-label">èã‹ã‚ŒãŸã‚‰ã“ã‚Œã‚’ç­”ãˆã‚‹ï¼ˆ3è¾ºåˆè¨ˆï¼‰</div>
          <div class="total-val"><span id="valTotal">---</span> cm</div>
          <div style="font-size:0.8em;color:#555;">(æ‰‹æ•°æ–™ç›®å®‰: <span id="valFee">---</span>å††)</div>
        </div>
      </div>

      <a href="tel:0570070053" class="call-btn">
        ğŸ“ å—ä»˜ã‚»ãƒ³ã‚¿ãƒ¼ã¸é›»è©±ã™ã‚‹
        <span class="call-sub">æºå¸¯ãƒ»ã‚¹ãƒãƒ›ç”¨: 0570-07-0053</span>
      </a>
      <p class="muted" style="margin-top:8px;font-size:0.75em;">
        å—ä»˜: æœˆï½åœŸ 9:00ï½17:00 (ç¥æ—¥ã‚‚å—ä»˜)<br>
        â€»å›ºå®šé›»è©±ã‹ã‚‰ã¯ <a href="tel:0120790053">0120-79-0053</a>
      </p>
    </div>

    <div id="waitingMsg" style="padding:20px; color:#666;">
      å¯¸æ³•ã‚’æ¸¬å®šã™ã‚‹ã¨ã€ã“ã“ã«<br><b>ã€Œèª­ã¿ä¸Šã’ç”¨ã‚«ãƒ³ãƒšã€</b>ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
    </div>
  </div>
</div>

<script async src="https://docs.opencv.org/4.x/opencv.js" onload="console.log('OpenCV loaded')"></script>
<script>
var REAL_LEN_MM = 100; // 100mmåŸºæº–
function $(id){ return document.getElementById(id); }

// çŠ¶æ…‹ç®¡ç†
var S = {
  top:  { bg:null, mode:"idle", clicks:[], rect:null, scale:null, W:null, D:null, scalePoints:[], aimingCursor:null },
  side: { bg:null, mode:"idle", clicks:[], rect:null, scale:null, H:null, scalePoints:[], aimingCursor:null }
};

// --- CanvasåŸºæœ¬å‡¦ç† ---
function loadToCanvas(file, canvasId, kind){
  if(!file) return;
  var canvas = $(canvasId);
  var ctx = canvas.getContext("2d");
  var img = new Image();
  img.onload = function(){
    var maxW = 800, maxH = 800;
    var w = img.naturalWidth, h = img.naturalHeight;
    var s = Math.min(maxW/w, maxH/h);
    canvas.width = Math.round(w*s);
    canvas.height = Math.round(h*s);
    
    ctx.drawImage(img,0,0,canvas.width,canvas.height);
    S[kind].bg = ctx.getImageData(0,0,canvas.width,canvas.height);
    
    // ãƒªã‚»ãƒƒãƒˆ
    S[kind].mode = "idle";
    S[kind].clicks = [];
    S[kind].rect = null;
    S[kind].scale = null;
    S[kind].scalePoints = [];
    S[kind].aimingCursor = null;
    
    if(kind==="top"){ S.top.W=null; S.top.D=null; } else { S.side.H=null; }
    
    $(kind+"Msg").innerHTML = "æ“ä½œãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãã ã•ã„";
    updateInfo(kind);
    drawOverlay(kind);
  };
  var reader = new FileReader();
  reader.onload = function(e){ img.src = e.target.result; };
  reader.readAsDataURL(file);
}

// æç”»ãƒ«ãƒ¼ãƒ—
function drawOverlay(kind){
  var canvas = $(kind+"Canvas");
  var ctx = canvas.getContext("2d");
  var st = S[kind];
  
  if(st.bg) ctx.putImageData(st.bg,0,0);
  else ctx.clearRect(0,0,canvas.width,canvas.height);

  // ç¢ºå®šç‚¹
  var points = (st.mode==="scale" && st.clicks.length>0) ? st.clicks : st.scalePoints;
  if(points){
    ctx.lineWidth=2;
    for(var i=0; i<points.length; i++){
      var p = points[i];
      ctx.fillStyle="#2b74ff";
      ctx.beginPath(); ctx.arc(p.x, p.y, 5, 0, Math.PI*2); ctx.fill();
      ctx.fillStyle="#fff"; ctx.strokeStyle="#000"; ctx.font="bold 14px sans-serif";
      ctx.strokeText(i+1, p.x+8, p.y-8);
      ctx.fillText(i+1, p.x+8, p.y-8);
    }
    if(points.length===2){
      ctx.strokeStyle="#2b74ff";
      ctx.beginPath(); ctx.moveTo(points[0].x, points[0].y); ctx.lineTo(points[1].x, points[1].y); ctx.stroke();
    }
  }

  // ç…§æº–ã‚«ãƒ¼ã‚½ãƒ« (ã‚ªãƒ•ã‚»ãƒƒãƒˆè¡¨ç¤º)
  if(st.aimingCursor){
    var cx = st.aimingCursor.x;
    var cy = st.aimingCursor.y;
    ctx.strokeStyle = "#ff00ff"; ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(cx - 20, cy); ctx.lineTo(cx + 20, cy);
    ctx.moveTo(cx, cy - 20); ctx.lineTo(cx, cy + 20);
    ctx.stroke();
    ctx.beginPath(); ctx.arc(cx, cy, 15, 0, Math.PI*2); ctx.stroke();
    ctx.fillStyle = "#ff00ff"; ctx.beginPath(); ctx.arc(cx, cy, 2, 0, Math.PI*2); ctx.fill();
  }

  // çŸ©å½¢
  if(st.rect){
    ctx.strokeStyle="#ff3b30"; ctx.lineWidth=3;
    ctx.strokeRect(st.rect.x, st.rect.y, st.rect.w, st.rect.h);
  }
}

// åº§æ¨™å–å¾— (ã‚ªãƒ•ã‚»ãƒƒãƒˆæ©Ÿèƒ½ä»˜ã)
function getCanvasPoint(ev, canvas, isOffset){
  var rect = canvas.getBoundingClientRect();
  var clientX, clientY;
  
  if(ev.touches && ev.touches.length>0){
    clientX = ev.touches[0].clientX;
    clientY = ev.touches[0].clientY;
  } else if(ev.changedTouches && ev.changedTouches.length>0){
    clientX = ev.changedTouches[0].clientX;
    clientY = ev.changedTouches[0].clientY;
  } else {
    clientX = ev.clientX;
    clientY = ev.clientY;
  }

  if(isOffset){
    clientY = clientY - 60; // 60pxä¸Šã«ã‚ªãƒ•ã‚»ãƒƒãƒˆ
  }

  var scaleX = canvas.width / rect.width;
  var scaleY = canvas.height / rect.height;

  return {
    x: (clientX - rect.left) * scaleX,
    y: (clientY - rect.top) * scaleY
  };
}

// ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
function setupCanvasEvents(kind){
  var canvas = $(kind+"Canvas");
  var st = S[kind];
  var isDragging = false;
  var dragStart = null; 

  canvas.addEventListener("touchstart", function(ev){
    ev.preventDefault();
    if(st.mode === "scale"){
      st.aimingCursor = getCanvasPoint(ev, canvas, true); 
      drawOverlay(kind);
    } else if(st.mode === "manual"){
      isDragging = true;
      dragStart = getCanvasPoint(ev, canvas, true);
    }
  }, {passive:false});

  canvas.addEventListener("touchmove", function(ev){
    ev.preventDefault();
    if(st.mode === "scale"){
      st.aimingCursor = getCanvasPoint(ev, canvas, true);
      drawOverlay(kind);
    } else if(st.mode === "manual" && isDragging){
      var cur = getCanvasPoint(ev, canvas, true);
      st.rect = {
        x: Math.min(dragStart.x, cur.x), y: Math.min(dragStart.y, cur.y),
        w: Math.abs(dragStart.x - cur.x), h: Math.abs(dragStart.y - cur.y)
      };
      drawOverlay(kind);
    }
  }, {passive:false});

  canvas.addEventListener("touchend", function(ev){
    ev.preventDefault();
    if(st.mode === "scale" && st.aimingCursor){
      st.clicks.push(st.aimingCursor);
      st.aimingCursor = null; 
      if(st.clicks.length > 2) st.clicks.shift();
      drawOverlay(kind);
      if(st.clicks.length === 2) commitScale(kind);
    } else if(st.mode === "manual" && isDragging){
      isDragging = false;
      applyManualRect(kind);
      drawOverlay(kind);
    }
  }, {passive:false});

  canvas.addEventListener("mousedown", function(ev){
    if(st.mode === "scale"){
      var p = getCanvasPoint(ev, canvas, false);
      st.clicks.push(p);
      if(st.clicks.length > 2) st.clicks.shift();
      drawOverlay(kind);
      if(st.clicks.length === 2) commitScale(kind);
    } else if(st.mode === "manual"){
      isDragging = true;
      dragStart = getCanvasPoint(ev, canvas, false);
    }
  });
  
  canvas.addEventListener("mousemove", function(ev){
    if(st.mode==="manual" && isDragging){
      var cur = getCanvasPoint(ev, canvas, false);
      st.rect = {
        x: Math.min(dragStart.x, cur.x), y: Math.min(dragStart.y, cur.y),
        w: Math.abs(dragStart.x - cur.x), h: Math.abs(dragStart.y - cur.y)
      };
      drawOverlay(kind);
    }
  });

  canvas.addEventListener("mouseup", function(){
    if(st.mode==="manual" && isDragging){
      isDragging = false; applyManualRect(kind); drawOverlay(kind);
    }
  });
}

// ãƒ­ã‚¸ãƒƒã‚¯
function commitScale(kind){
  var st = S[kind];
  var a = st.clicks[0], b = st.clicks[1];
  var dist = Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2));
  if(dist < 5){ alert("ç‚¹ãŒè¿‘ã™ãã¾ã™"); st.clicks=[]; drawOverlay(kind); return; }
  
  st.scale = REAL_LEN_MM / dist;
  st.scalePoints = [a, b];
  st.clicks = [];
  st.mode = "idle";
  $(kind+"Msg").innerHTML = "ã‚¹ã‚±ãƒ¼ãƒ«è¨­å®šæ¸ˆã€‚è‡ªå‹•æŠ½å‡ºã‹æ‰‹å‹•çŸ©å½¢ã‚’é¸ã‚“ã§ãã ã•ã„";
  drawOverlay(kind);
  updateInfo(kind);
}

function applyManualRect(kind){
  var st = S[kind];
  if(!st.rect || !st.scale) return;
  if(kind==="top"){ st.W = st.rect.w * st.scale; st.D = st.rect.h * st.scale; }
  else { st.H = st.rect.h * st.scale; }
  updateInfo(kind);
}

function autoExtract(kind){
  var st = S[kind];
  if(!st.scale){ alert("å…ˆã«ã‚¹ã‚±ãƒ¼ãƒ«æŒ‡å®šã‚’ã—ã¦ãã ã•ã„"); return; }
  if(!st.bg){ alert("ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“"); return; }
  
  var canvas = $(kind+"Canvas");
  var src = cv.matFromImageData(st.bg);
  var gray = new cv.Mat(), blur = new cv.Mat(), thr = new cv.Mat();
  
  cv.cvtColor(src, gray, cv.COLOR_RGBA2GRAY);
  cv.GaussianBlur(gray, blur, new cv.Size(5,5), 0);
  cv.adaptiveThreshold(blur, thr, 255, cv.ADAPTIVE_THRESH_GAUSSIAN_C, cv.THRESH_BINARY_INV, 11, 2);
  
  var contours = new cv.MatVector();
  var hierarchy = new cv.Mat();
  cv.findContours(thr, contours, hierarchy, cv.RETR_EXTERNAL, cv.CHAIN_APPROX_SIMPLE);
  
  var maxArea=0, maxRect=null;
  for(var i=0; i<contours.size(); i++){
    var cnt = contours.get(i);
    var area = cv.contourArea(cnt);
    if(area > maxArea){
      maxArea = area;
      maxRect = cv.boundingRect(cnt);
    }
  }
  
  if(maxRect && maxArea > 1000){
    st.rect = { x:maxRect.x, y:maxRect.y, w:maxRect.width, h:maxRect.height };
    applyManualRect(kind);
    drawOverlay(kind);
  } else {
    alert("ç‰©ä½“ã‚’è‡ªå‹•æ¤œå‡ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚æ‰‹å‹•ã§çŸ©å½¢ã‚’æã„ã¦ãã ã•ã„ã€‚");
  }
  
  src.delete(); gray.delete(); blur.delete(); thr.delete(); contours.delete(); hierarchy.delete();
}

function updateInfo(kind){
  var st = S[kind];
  var el = $(kind+"Info");
  if(kind==="top") el.textContent = "W: "+(st.W?st.W.toFixed(0):"-")+" / D: "+(st.D?st.D.toFixed(0):"-")+" mm";
  else el.textContent = "H: "+(st.H?st.H.toFixed(0):"-")+" mm";
  
  updatePhoneScript();
}

// â˜…é›»è©±ç”¨ã‚«ãƒ³ãƒšæ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯
function updatePhoneScript(){
  var W=S.top.W||0, D=S.top.D||0, H=S.side.H||0;
  var scriptArea = $("scriptArea");
  var waitingMsg = $("waitingMsg");

  if(W > 0 && D > 0 && H > 0){
    var w_cm = Math.round(W/10);
    var d_cm = Math.round(D/10);
    var h_cm = Math.round(H/10);
    var total_mm = W+D+H;
    var total_cm = Math.ceil(total_mm/10); // åˆè¨ˆã¯åˆ‡ã‚Šä¸Šã’å®‰å…¨ç­–

    // æ‰‹æ•°æ–™æ¨å®š (å¤§é˜ªå¸‚ã‚µã‚¤ã‚ºåŸºæº–)
    var fee = 0;
    if(total_mm < 1500) fee = 200;
    else if(total_mm < 2000) fee = 400;
    else if(total_mm < 2500) fee = 700;
    else fee = 1000;

    $("valW").textContent = w_cm;
    $("valD").textContent = d_cm;
    $("valH").textContent = h_cm;
    $("valTotal").textContent = total_cm;
    $("valFee").textContent = fee.toLocaleString();

    waitingMsg.style.display = "none";
    scriptArea.style.display = "block";
  } else {
    waitingMsg.style.display = "block";
    scriptArea.style.display = "none";
  }
}

window.onload = function(){
  $("topFile").onchange = function(e){ loadToCanvas(e.target.files[0], "topCanvas", "top"); };
  $("sideFile").onchange = function(e){ loadToCanvas(e.target.files[0], "sideCanvas", "side"); };
  
  $("topScale").onclick = function(){ S.top.mode="scale"; S.top.clicks=[]; $("topMsg").innerText="å®šè¦ã®ç«¯ã‚’æŒ‡å®š(ã‚ªãƒ•ã‚»ãƒƒãƒˆ)"; drawOverlay("top"); };
  $("sideScale").onclick = function(){ S.side.mode="scale"; S.side.clicks=[]; $("sideMsg").innerText="å®šè¦ã®ç«¯ã‚’æŒ‡å®š(ã‚ªãƒ•ã‚»ãƒƒãƒˆ)"; drawOverlay("side"); };
  
  $("topManual").onclick = function(){ S.top.mode="manual"; S.top.rect=null; $("topMsg").innerText="ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å›²ã‚€(ã‚ªãƒ•ã‚»ãƒƒãƒˆ)"; drawOverlay("top"); };
  $("sideManual").onclick = function(){ S.side.mode="manual"; S.side.rect=null; $("sideMsg").innerText="ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å›²ã‚€(ã‚ªãƒ•ã‚»ãƒƒãƒˆ)"; drawOverlay("side"); };
  
  $("topAuto").onclick = function(){ autoExtract("top"); };
  $("sideAuto").onclick = function(){ autoExtract("side"); };
  
  setupCanvasEvents("top");
  setupCanvasEvents("side");
};
</script>
</body>
</html>
